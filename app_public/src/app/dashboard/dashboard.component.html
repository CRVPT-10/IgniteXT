<!-- Header / Navbar -->
<div class="header">
  <div class="logo-container">
    <img src="assets/images/ignite-xt-logo.png" alt="IgniteXT Logo" class="logo">
    <span class="logo-text"><span class="logo-i">I</span>gnite<span class="logo-xt">XT</span></span>
  </div>
  <button class="logout-btn" (click)="logout()">Logout</button>
</div>

<div class="dashboard-container">
  <h2>Welcome, {{ user?.name || user?.email || 'User' }}</h2>

  <!-- Faculty Upload Section -->
  <div *ngIf="user?.role === 'faculty'" class="upload-section">
    <h3>ðŸ“¤ Upload Study Material</h3>

    <div class="form-group">
      <label for="branch">Branch:</label>
      <select id="branch" [(ngModel)]="selectedBranch" (change)="onBranchChange()">
        <option value="">Select Branch</option>
        <option *ngFor="let branch of branches" [value]="branch">{{ branch }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="year">Year:</label>
      <select id="year" [(ngModel)]="selectedYear" (change)="onYearChange()">
        <option value="">Select Year</option>
        <option *ngFor="let year of years" [value]="year">{{ year }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="subject">Subject:</label>
      <select id="subject" [(ngModel)]="selectedSubject">
        <option value="">Select Subject</option>
        <option *ngFor="let subject of subjects" [value]="subject">{{ subject }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="file">File:</label>
      <input type="file" id="file" (change)="handleFileInput($event)" />
    </div>

    <button (click)="upload()" class="btn-upload">Upload</button>
  </div>

  <!-- Student message -->
  <div *ngIf="user?.role === 'student'" class="student-message">
    <p><strong>Note:</strong> Students can only browse and download materials.</p>
  </div>

  <hr />

  <!-- View Materials Section -->
  <div class="materials-section">
    <h3>ðŸ“š View Study Materials</h3>

    <div class="filters">
      <label>Branch:</label>
      <select [(ngModel)]="selectedBranch" (change)="onBranchChange()">
        <option value="">Select Branch</option>
        <option *ngFor="let branch of branches" [value]="branch">{{ branch }}</option>
      </select>

      <label>Year:</label>
      <select [(ngModel)]="selectedYear" (change)="onYearChange()">
        <option value="">Select Year</option>
        <option *ngFor="let year of years" [value]="year">{{ year }}</option>
      </select>

      <label>Subject:</label>
      <select [(ngModel)]="selectedSubject">
        <option value="">Select Subject</option>
        <option *ngFor="let subject of subjects" [value]="subject">{{ subject }}</option>
      </select>

      <button (click)="fetchMaterials()" class="btn-fetch">Fetch Materials</button>
    </div>

    <p class="message" *ngIf="message">{{ message }}</p>

    <div *ngIf="materials.length > 0" class="materials-list">
      <table>
        <thead>
          <tr>
            <th>Filename</th>
            <th>Branch</th>
            <th>Year</th>
            <th>Subject</th>
            <th>Uploaded By</th>
            <th>Date</th>
            <th>Download</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let material of materials">
            <td>{{ material.filename }}</td>
            <td>{{ material.branch }}</td>
            <td>{{ material.year }}</td>
            <td>{{ material.subject }}</td>
            <td>{{ material.uploadedBy }}</td>
            <td>{{ material.uploadedAt | date:'medium' }}</td>
            <td>
                <button class="btn-download" (click)="downloadMaterial(material)">
    Download
  </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
